import telebot
import requests
import os

# Настройки
TELEGRAM_TOKEN = "ваш_токен"
OPENROUTER_API_KEY = "ваш_api_ключ"
OPENROUTER_URL = "https://openrouter.ai/api/v1/chat/completions"

bot = telebot.TeleBot(TELEGRAM_TOKEN)

@bot.message_handler(func=lambda message: True)
def handle_message(message):
    try:
        # Формируем запрос к ИИ
        headers = {
            "Authorization": f"Bearer {OPENROUTER_API_KEY}",
            "Content-Type": "application/json"
        }
        
        data = {
            "model": "gpt-4o-mini",  # или другая модель
            "messages": [
                {"role": "user", "content": message.text}
            ]
        }
        
        # Отправляем запрос
        response = requests.post(OPENROUTER_URL, 
                               json=data, 
                               headers=headers)
        
        if response.status_code == 200:
            result = response.json()
            answer = result["choices"][0]["message"]["content"]
            
            # Отправляем ответ пользователю
            bot.reply_to(message, answer)
        else:
            bot.reply_to(message, "Ошибка API")
            
    except Exception as e:
        bot.reply_to(message, f"Ошибка: {str(e)}")

# Запуск бота
if __name__ == "__main__":
    print("Бот запущен...")
    bot.polling(none_stop=True)
